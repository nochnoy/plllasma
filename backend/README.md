# Plllasma Backend (NestJS)

NestJS бэкенд для проекта Plllasma с базовым функционалом авторизации, копирующим логику из PHP бэкенда.

## Установка и запуск

1. Установите зависимости:
```bash
npm install
```

2. Скопируйте файл конфигурации:
```bash
copy env.example .env
```

3. Настройте переменные окружения в файле `.env`:
```
DB_HOST=localhost
DB_PORT=3306
DB_USER=plllasma
DB_PASSWORD=your_password_here
DB_NAME=plllasma
JWT_SECRET=your-jwt-secret-key-here
NODE_ENV=development
```

4. Запустите приложение в режиме разработки:
```bash
npm run start:dev
```

Приложение будет доступно по адресу: http://localhost:3001

## API Endpoints

### Авторизация

- `POST /api/auth/login` - Авторизация по логину/паролю или по токену из cookies
- `GET /api/auth/me` - Получение информации о текущем пользователе
- `POST /api/auth/logout` - Выход из системы

## Особенности реализации

Система авторизации полностью копирует логику из PHP бэкенда:

1. **Авторизация по логину/паролю** - использует прямую проверку в БД (без хеширования, как в оригинале)
2. **Токены в cookies** - генерирует GUID и сохраняет в поле `logkey` таблицы `tbl_users`
3. **CORS настройки** - идентичны настройкам в PHP
4. **Защита от брутфорса** - задержка в 2 секунды при неудачных попытках входа
5. **Права доступа** - функции проверки прав полностью копируют логику из PHP

## Структура базы данных

Используются те же таблицы что и в PHP бэкенде:
- `tbl_users` - пользователи
- `tbl_access` - права доступа к каналам
- `lnk_user_ignor` - игнорируемые пользователи

## Дополнительные возможности

В отличие от PHP версии, NestJS бэкенд также поддерживает:
- JWT токены для дополнительной безопасности
- Валидация входных данных с помощью class-validator
- TypeORM для работы с базой данных
- Автоматическая генерация OpenAPI документации


