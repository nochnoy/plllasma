@if (isLoading) {
  <div class="spinner"></div>
} @else {
  @if (error) {
    <div class="error">
      <div>üôÅ</div>
      <div>{{error}}</div>
    </div>
  } @else {
    @if (attachment) {
      @if (!isImageMagnified) {
        <div class="attachment">

          <h2>{{attachment.filename}}</h2>

          @switch (attachment.type) {

            @case ('image') {
              @if (!isImageMagnified) {
                <img
                  class="image stage"
                  [src]="getAttachmentImageUrl()"
                  [alt]="attachment.filename || ''"
                  (click)="isImageMagnified = true"
                  (contextmenu)="$event.preventDefault(); $event.stopPropagation(); downloadFile();"
                />
              }
            }

            @case ('video') {
              @if (attachment.file) {
                @if (canPlayVideo()) {
                  <div class="video">
                    <video
                      class="content-normal video"
                      (contextmenu)="$event.preventDefault(); $event.stopPropagation();"
                      [src]="getAttachmentImageUrl()"
                      [muted]="'muted'"
                      controls
                      loop
                      autoplay
                    >
                    </video>
                  </div>

                }
              }
            }

          }

          @if (attachment.file) {
            <button
              (click)="downloadFile()"
              class="download"
            >
              –°–∫–∞—á–∞—Ç—å {{getFileSize()}}
            </button>
          } @else {
            <div class="unloaded">
              üôÅ –§–∞–π–ª –±—ã–ª –≤—ã–≥—Ä—É–∂–µ–Ω –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞
            </div>
          }

          <div class="info">
            <div>–°–∫–∞—á–∞–ª–∏ {{attachment.downloads}}</div>
            <div>–°–º–æ—Ç—Ä–µ–ª–∏ {{attachment.views}}</div>
          </div>

          @if (attachment.preview) {
            <img [src]="getPreviewUrl()">
          }

        </div>

      } @else {

        <!-- –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞-->
        <img
          class="image-magnified"
          [src]="getAttachmentImageUrl()"
          [alt]="attachment.filename || ''"
          (click)="isImageMagnified = false"
          (contextmenu)="$event.preventDefault(); $event.stopPropagation(); downloadFile();"
        />

      }
    }
  }
}

