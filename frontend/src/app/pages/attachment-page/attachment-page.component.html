@if (isLoading) {
  <div class="spinner"></div>
} @else {
  @if (error) {
    <div class="error">
      <div>üôÅ</div>
      <div>{{error}}</div>
    </div>
  } @else {
    @if (attachment) {
      <div class="attachment">

        <h2>{{attachment.filename}}</h2>

        @switch (attachment.type) {

          @case ('image') {
            <img
              class="image stage"
              [src]="getAttachmentImageUrl()"
              [alt]="attachment.filename || ''"
              (click)="isImageMagnified = !isImageMagnified"
              (contextmenu)="$event.preventDefault(); $event.stopPropagation(); downloadFile();"
            />
          }

          @case ('video') {
            @if (attachment.file) {
              @if (canPlayVideo()) {
                <div class="video">
                  <video
                    class="content-normal video"
                    (contextmenu)="$event.preventDefault(); $event.stopPropagation();"
                    [src]="getAttachmentImageUrl()"
                    [muted]="'muted'"
                    controls
                    loop
                    autoplay
                  >
                  </video>
                </div>

              }
            }
          }

        }

        @if (attachment.file) {
          <button
            (click)="downloadFile()"
            class="download"
          >
            –°–∫–∞—á–∞—Ç—å {{getFileSize()}}
          </button>
        } @else {
          <div class="unloaded">
            üôÅ –§–∞–π–ª –±—ã–ª –≤—ã–≥—Ä—É–∂–µ–Ω –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞
          </div>
        }

        <div class="info">
          <div>–°–∫–∞—á–∞–ª–∏ {{attachment.downloads}}</div>
          <div>–°–º–æ—Ç—Ä–µ–ª–∏ {{attachment.views}}</div>
        </div>

        @if (attachment.preview) {
          <img [src]="getPreviewUrl()">
        }

      </div>
    }
  }
}

