<div class="three-column-page">
  <aside class="aside">
    <app-main-menu></app-main-menu>
  </aside>
  <main class="main">

    <section>

      <header>
        <div>
          <h1 [class.spinner]="isLoading">–í—Å–µ –∫–∞–Ω–∞–ª—ã</h1>
          <div>üöß –í –ø—Ä–æ—Ü–µ—Å—Å–µ. –ü–æ—Ç–æ–º —Ç—É—Ç –±—É–¥–µ—Ç —Ä–∞–∑–≤–µ—Å–∏—Å—Ç—ã–π –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥.</div>
        </div>
        <div>

        </div>
      </header>

      <div class="info">
        <div class="search" *ngIf="!isLoading">
          <input autofocus [(ngModel)]="searchPhrase" (ngModelChange)="onFilter()" placeholder="–ü–æ–∏—Å–∫">
        </div>   
      </div>

      <ng-container *ngIf="!searchPhrase">
        <div class="district">
          <div class="channels">
            <ng-container *ngFor="let channel of channelsAll">
              <ng-container [ngTemplateOutlet]="memberTemplate" [ngTemplateOutletContext]="{channel: channel}"></ng-container>
            </ng-container>
          </div>
        </div>
      </ng-container>

      <ng-container *ngIf="searchPhrase">
        <div class="district">
          <label>–ü–æ–∏—Å–∫ –∫–∞–Ω–∞–ª–∞ "{{searchPhrase}}"</label>
          <a class="search-clear" href (click)="onSearchClearClick($event)">–æ—Ç–º–µ–Ω–∏—Ç—å</a>
          <div class="channels" *ngIf="channelsSearching.length">
            <ng-container *ngFor="let channel of channelsSearching">
              <ng-container [ngTemplateOutlet]="memberTemplate" [ngTemplateOutletContext]="{channel: channel}"></ng-container>
            </ng-container>
          </div>
        </div>
        <div *ngIf="!channelsSearching.length">–ù–µ –Ω–∞–π–¥–µ–Ω–æ</div>
      </ng-container>

      <div class="info">
        üì¨ –û—Ç–ø–∏—Å—ã–≤–∞—è—Å—å –æ—Ç –∫–∞–Ω–∞–ª–∞, –≤—ã –µ–≥–æ —É–¥–∞–ª—è–µ—Ç–µ –∏–∑&nbsp;–±–æ–∫–æ–≤–æ–≥–æ –º–µ–Ω—é.<br>
        –ê –ø–æ–¥–ø–∏—Å—ã–≤–∞—è—Å—å - –¥–æ–±–∞–≤–ª—è–µ—Ç–µ!
      </div>      

    </section>

    <section>
      <header>
        <h1>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π</h1>
        <div>–∫–∞–Ω–∞–ª</div>
      </header> 
      <form [formGroup]="newChannelForm">

        <input class="input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞" name="name" type="text" maxlength="14" formControlName="name" autofocus>
        <textarea class="input" placeholder="–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä –ø—Ä–æ 18+" name="disclaimer" type="text" formControlName="disclaimer"></textarea>
        <div class="user-line">
          <div class="user" (click)="onGhostClick()">
            <ng-container *ngIf="!isGhost">
              <img class="avatar" [src]="'https://plllasma.com/i/' + userIcon" />{{userName}}‚ñæ
            </ng-container>
            <ng-container *ngIf="isGhost">
              <div class="icon"></div>{{'–ü—Ä–∏–≤–∏–¥–µ–Ω–∏–µ'}}‚ñ¥
            </ng-container>
          </div>
        </div>        
        <button class="button"
                [disabled]="newChannelForm.invalid"
                (click)="onNewChannelClick()">
          –°–æ–∑–¥–∞—Ç—å
        </button>

      </form>      
    </section>

  </main>
  <div class="sidebar" [class.sidebar-halloween]="isHalloween">

    <div class="halloween" *ngIf="isHalloween">
      <ng-container *ngIf="currentYear === 2023">
        –ö–æ–Ω–µ—Ü –±–ª–∏–∑–æ–∫! –ö–∞–Ω–∞–ª—ã –º—É—Ç–∏—Ä—É—é—Ç.
        –°–∫–æ—Ä–æ –æ–Ω–∏ –Ω–∞—á–Ω—É—Ç —Ä–∞–∑–º–Ω–æ–∂–∞—Ç—å—Å—è
        –∏ –∏—Ö —Å—Ç–∞–Ω–µ—Ç —Å—Ç–æ–ª—å–∫–æ, —á—Ç–æ –º—ã –≤—Å–µ —É–º—Ä—ë–º!
        –ò&nbsp;—á–µ—Ä–≤–∏ —Å—ä–µ–¥—è—Ç –Ω–∞—à–∏ –≥–ª–∞–∑–∞!<br>
      </ng-container>
      <img src="assets/img/halloween-pumpkin.png">
    </div>

  </div>
</div>

<ng-template #memberTemplate let-channel='channel'>
  <a
    class="name"
    [class.noaccess]="!channel.role || channel.role === 9"
    [routerLink]="'/channel/' + channel.id_place">
      <i *ngIf="channel.id_place <= 47"><img src="assets/img/channel-open.png"></i>
      <i *ngIf="channel.id_place > 47">üéÉ</i>
      {{channel.name}}
    </a>
</ng-template>